name: Run Claude Code Command

on:
  workflow_dispatch:
    inputs:
      message:
        description: 'Message to send to claude-code'
        required: true
        default: 'hai apa kabar'
        type: string

jobs:
  run-claude-code:
    runs-on: macos-latest  # Changed to macOS since we need Homebrew

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Setup Homebrew
      run: |
        # Homebrew is pre-installed on macOS runners
        brew --version

    - name: Install Claude Code via Homebrew
      run: |
        # Install Claude Code
        brew install --cask claude-code

        # Verify installation
        echo "Checking if claude-code is available..."
        which claude-code
        claude-code --version || echo "Version check failed, but installation might have succeeded"

    - name: Run Claude Code command
      run: |
        echo "Running: claude-code -p \"${{ github.event.inputs.message }}\""
        claude-code -p "${{ github.event.inputs.message }}"